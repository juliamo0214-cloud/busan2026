<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÈáúÂ±±Êô∫ÊÖßÂä©Êâã 2026</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background: #fffafa; color: #4a3a3a; -webkit-tap-highlight-color: transparent; }
        .watercolor-bg { background: radial-gradient(circle at 10% 10%, #ffd1dc 0%, transparent 50%), radial-gradient(circle at 90% 90%, #fff0f5 0%, transparent 50%); background-attachment: fixed; }
        .app-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-radius: 28px; border: 1px solid rgba(255, 255, 255, 0.6); box-shadow: 0 10px 25px rgba(255, 182, 193, 0.15); }
        .day-active { background: #ff8fa3 !important; color: white !important; transform: scale(1.05); }
        .transit-link { border-left: 2px dashed #ffb2c1; margin-left: 1.8rem; padding: 0.8rem 0 0.8rem 1.2rem; }
        [v-cloak] { display: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .info-card-1 { background: #fff0f5; border-left: 8px solid #ffb6c1; }
        .info-card-2 { background: #f0f8ff; border-left: 8px solid #add8e6; }
        .info-card-3 { background: #f5fffa; border-left: 8px solid #98fb98; }
        .info-card-4 { background: #fffaf0; border-left: 8px solid #ffdab9; }
        .info-card-5 { background: #f8f8ff; border-left: 8px solid #e6e6fa; }
    </style>
</head>
<body class="watercolor-bg min-h-screen pb-48">
    <div id="app" v-cloak class="max-w-md mx-auto px-5 pt-8">
        
        <header class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-black text-[#ff8fa3]">{{ tabTitle }}</h1>
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Busan 2026 / {{ currentTimeDisplay }}</p>
            </div>
            <button @click="openMainModal" class="w-10 h-10 rounded-full bg-white shadow-md flex items-center justify-center text-[#ff8fa3] active:scale-90 transition">
                <i data-lucide="plus"></i>
            </button>
        </header>

        <nav v-if="activeTab !== 'info'" class="flex gap-2 mb-4 overflow-x-auto pb-2 no-scrollbar">
            <button v-for="(day, idx) in itinerary" :key="idx" @click="selectedDayIdx = idx"
                    :class="['flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center bg-white text-gray-400 font-bold transition-all', { 'day-active': selectedDayIdx === idx }]">
                <span class="text-[9px] opacity-70">Day {{ idx + 1 }}</span>
                <span class="text-sm font-black">{{ day.date.substring(5) }}</span>
            </button>
        </nav>

        <main v-if="activeTab === 'itinerary'">
            <section class="app-card p-5 mb-6 border-none shadow-sm bg-white/40 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="text-orange-400" :class="{'animate-pulse': loadingWeather}"><i :data-lucide="getWeatherIcon(selectedDayIdx)"></i></div>
                    <div>
                        <h4 class="text-[10px] font-black text-gray-400 uppercase">{{ loadingWeather ? 'Ê≠£Âú®ÂÆö‰ΩçÂ§©Ê∞£...' : (selectedDayIdx < 3 ? 'üî¥ ÈáúÂ±±Âç≥ÊôÇÈ†êÂ†±' : '‚ö™ Êô∫ÊÖßÂõûÈÄÄÈ†êÊ∏¨') }}</h4>
                        <div class="flex items-baseline gap-2">
                            <span class="text-xl font-black text-gray-700">{{ weatherForecast[selectedDayIdx].temp }}</span>
                            <span class="text-[10px] font-bold text-gray-400">{{ weatherForecast[selectedDayIdx].cond }}</span>
                        </div>
                    </div>
                </div>
                <div class="text-right text-[10px] font-black text-pink-400">Ê´ªËä±: {{ weatherForecast[selectedDayIdx].sakura }}</div>
            </section>

            <div v-for="(item, idx) in sortedUpcoming" :key="item.id">
                <div class="app-card p-6 mb-2 relative overflow-hidden">
                    <div class="absolute top-0 right-0 px-3 py-1 bg-pink-50 text-[9px] font-black text-pink-400 rounded-bl-xl">
                        {{ weatherForecast[selectedDayIdx].temp }} ¬∑ {{ item.type }}
                    </div>
                    
                    <div class="flex justify-between items-start mb-2 mt-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xs font-black text-pink-400">{{ item.time }}</span>
                            <span v-if="item.tagName" :class="getTagClass(item.tagColor)" class="text-[8px] px-2 py-0.5 rounded text-white font-bold">{{ item.tagName }}</span>
                        </div>
                        <div class="flex gap-3">
                            <button @click="editItinerary(item.originalIdx)" class="text-blue-300"><i data-lucide="edit-3" class="w-4 h-4"></i></button>
                            <button @click="deleteItinerary(item.originalIdx)" class="text-red-200"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                    <h3 class="font-bold text-gray-800 flex items-center gap-1">
                        {{ item.location }}
                        <button @click="goMap('naver', item.location)" class="text-[#03C75A]"><i data-lucide="map-pin" class="w-3 h-3"></i></button>
                    </h3>
                    <p class="text-xs text-gray-500 mt-2 whitespace-pre-line">{{ item.desc }}</p>
                </div>

                <div v-if="idx < sortedUpcoming.length - 1" class="transit-link">
                    <div class="flex items-center gap-2 text-[10px] font-bold text-gray-400">
                        <i :data-lucide="getTransitIcon(item.transitWay)" class="w-3 h-3 text-pink-300"></i>
                        <span>{{ item.transitWay }} {{ item.transitTime }}ÂàÜ</span>
                    </div>
                </div>
            </div>
        </main>

        <main v-if="activeTab === 'budget'">
            <div class="app-card p-6 mb-6 bg-gradient-to-br from-pink-400 to-pink-300 text-white shadow-lg">
                <div class="flex justify-between items-start">
                    <div><p class="text-[10px] font-black opacity-80 uppercase tracking-widest">Êú¨Êó•Á∏ΩÈüìÂÖÉÊîØÂá∫</p><h2 class="text-3xl font-black">‚Ç© {{ dayTotalKRW.toLocaleString() }}</h2></div>
                    <div class="text-right"><p class="text-[10px] font-black opacity-80 uppercase tracking-widest">Á∏ΩÂè∞Âπ£‰º∞ÁÆó</p><h2 class="text-xl font-bold">NT$ {{ dayTotalTWD.toLocaleString() }}</h2></div>
                </div>
            </div>

            <div class="space-y-3">
                <div v-for="(exp, idx) in currentDayExpenses" :key="idx" class="app-card p-5 flex justify-between items-center">
                    <div class="flex-grow">
                        <div class="flex items-center gap-2">
                            <span class="text-sm font-black text-gray-800">‚Ç© {{ exp.amount.toLocaleString() }}</span>
                            <span class="text-[10px] font-bold text-blue-400">‚âà NT$ {{ Math.round(exp.amount * exchangeRate) }}</span>
                        </div>
                        <p class="text-[10px] text-gray-400 mt-1">
                            <span class="bg-gray-100 px-1 rounded">{{ exp.category }}</span> {{ exp.time }} | {{ exp.desc }}
                        </p>
                    </div>
                    <div class="flex gap-4">
                        <button @click="editExpense(idx)" class="text-blue-300"><i data-lucide="edit-2" class="w-4 h-4"></i></button>
                        <button @click="deleteExpense(idx)" class="text-red-200"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                    </div>
                </div>
            </div>
        </main>

        <main v-if="activeTab === 'info'" class="space-y-4">
            <div v-for="(info, idx) in travelInfo" :key="idx" :class="['app-card p-6 relative overflow-hidden', 'info-card-' + ((idx % 5) + 1)]">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-black text-gray-700 flex items-center gap-2">
                        <i :data-lucide="info.icon || 'file-text'" class="w-5 h-5 text-gray-400"></i> {{ info.title }}
                    </h3>
                    <div class="flex gap-3">
                        <button @click="editInfo(idx)" class="text-blue-400"><i data-lucide="edit-3" class="w-4 h-4"></i></button>
                        <button @click="deleteInfo(idx)" class="text-red-300"><i data-lucide="x" class="w-4 h-4"></i></button>
                    </div>
                </div>
                <div class="text-sm text-gray-600 whitespace-pre-wrap leading-relaxed">{{ info.content }}</div>
                <div class="absolute -bottom-2 -right-2 opacity-5 font-black text-4xl italic select-none">{{ info.title }}</div>
            </div>
            
            <button @click="addNewInfoField" class="w-full py-6 border-2 border-dashed border-pink-200 rounded-[28px] text-pink-300 font-black text-sm flex items-center justify-center gap-2 hover:bg-pink-50 transition">
                <i data-lucide="plus-circle"></i> Ôºã Êñ∞Â¢ûË≥áË®äÂÇôÂøòÈåÑ
            </button>
        </main>

        <div v-if="showModal" class="fixed inset-0 z-[100] flex items-end justify-center">
            <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" @click="showModal = false"></div>
            <div class="bg-white w-full rounded-t-[40px] p-8 pb-12 z-10 animate-slide-up max-h-[95vh] overflow-y-auto">
                <h2 class="text-center font-black text-gray-700 mb-6 text-lg">{{ modalTitle }}</h2>
                
                <div v-if="modalMode === 'itinerary'" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <select v-model="itineraryForm.day" class="p-4 bg-gray-50 rounded-2xl text-sm font-bold"><option v-for="(d,i) in itinerary" :value="i">Day {{i+1}}</option></select>
                        <input v-model="itineraryForm.time" type="time" class="p-4 bg-gray-50 rounded-2xl text-sm font-bold">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <select v-model="itineraryForm.type" class="p-4 bg-gray-50 rounded-2xl text-sm font-bold"><option>ÊôØÈªû</option><option>È§êÂª≥</option><option>‰∫§ÈÄö</option><option>Ë≥ºÁâ©</option></select>
                        <input v-model="itineraryForm.location" placeholder="Âú∞ÈªûÂêçÁ®±" class="p-4 bg-gray-50 rounded-2xl text-sm font-bold">
                    </div>
                    <div class="p-4 bg-gray-50 rounded-2xl flex gap-2">
                        <input v-model="itineraryForm.tagName" placeholder="Ê®ôÁ±§ÊñáÂ≠ó (Â¶Ç: ÂøÖÂéª)" class="flex-grow p-2 bg-white rounded-lg text-xs font-bold">
                        <button v-for="c in ['pink','blue','yellow']" @click="itineraryForm.tagColor = c" :class="[itineraryForm.tagColor===c?'ring-2 ring-gray-400':'', getTagClass(c)]" class="w-8 h-8 rounded"></button>
                    </div>
                    <textarea v-model="itineraryForm.desc" placeholder="ÂÇôË®ª„ÄÅÊïÖ‰∫ã..." class="w-full p-4 bg-gray-50 rounded-2xl text-sm h-24"></textarea>
                    <div class="p-4 bg-pink-50 rounded-2xl grid grid-cols-2 gap-2">
                        <select v-model="itineraryForm.transitWay" class="bg-white p-3 rounded-xl text-xs"><option>Ê≠•Ë°å</option><option>Ë®àÁ®ãËªä</option><option>È£õÊ©ü</option><option>Â∑¥Â£´</option><option>Âú∞Èêµ</option></select>
                        <input v-model.number="itineraryForm.transitTime" type="number" placeholder="ÂàÜÈêò" class="bg-white p-3 rounded-xl text-xs">
                    </div>
                    <button @click="saveItinerary" class="w-full py-4 bg-[#ff8fa3] text-white rounded-2xl font-black">ÂÑ≤Â≠òË°åÁ®ã</button>
                </div>

                <div v-if="modalMode === 'budget'" class="space-y-4">
                    <div class="grid grid-cols-2 gap-2">
                        <input v-model="expenseForm.date" type="date" class="p-4 bg-gray-50 rounded-2xl text-xs">
                        <input v-model="expenseForm.time" type="time" class="p-4 bg-gray-50 rounded-2xl text-xs">
                    </div>
                    <select v-model="expenseForm.category" class="w-full p-4 bg-gray-50 rounded-2xl text-sm font-bold">
                        <option>ËßÄÂÖâ</option><option>‰∫§ÈÄö</option><option>Ë≥ºÁâ©</option><option>È£≤È£ü</option><option>ÈõúÈ†Ö</option><option>ÂÖ∂‰ªñ</option>
                    </select>
                    <input v-model.number="expenseForm.amount" type="number" class="w-full p-4 bg-gray-50 rounded-2xl text-lg font-black" placeholder="‚Ç© ÈüìÂÖÉÈáëÈ°ç">
                    <input v-model="expenseForm.desc" placeholder="Ê∂àË≤ªÂÖßÂÆπË™™Êòé" class="w-full p-4 bg-gray-50 rounded-2xl text-sm">
                    <button @click="saveExpense" class="w-full py-4 bg-[#ff8fa3] text-white rounded-2xl font-black">ÂÑ≤Â≠òÊîØÂá∫</button>
                </div>

                <div v-if="modalMode === 'info'" class="space-y-4">
                    <input v-model="infoForm.title" placeholder="Ë≥áË®äÊ®ôÈ°å" class="w-full p-4 bg-gray-50 rounded-2xl text-sm font-black">
                    <textarea v-model="infoForm.content" placeholder="ÂÖßÂÆπ..." class="w-full p-4 bg-gray-50 rounded-2xl text-sm h-64"></textarea>
                    <button @click="saveInfo" class="w-full py-4 bg-[#ff8fa3] text-white rounded-2xl font-black">Êõ¥Êñ∞Ë≥áË®ä</button>
                </div>
            </div>
        </div>

        <nav class="fixed bottom-6 left-8 right-8 h-20 bg-white/90 backdrop-blur-xl rounded-full flex justify-around items-center px-4 shadow-2xl z-[90]">
            <button v-for="t in [['itinerary','calendar','Ë°åÁ®ã'],['budget','banknote','Ë®òÂ∏≥'],['info','shield-info','Ë≥áË®ä']]" :key="t[0]" @click="activeTab = t[0]" :class="{'text-[#ff8fa3]': activeTab === t[0]}" class="flex flex-col items-center text-gray-300">
                <i :data-lucide="t[1]"></i><span class="text-[9px] font-bold mt-1 uppercase">{{t[2]}}</span>
            </button>
        </nav>
    </div>

    <script>
        const { createApp, ref, computed, watch, onMounted } = Vue;
        createApp({
            setup() {
                const activeTab = ref('itinerary');
                const selectedDayIdx = ref(0);
                const showModal = ref(false);
                const modalMode = ref('itinerary');
                const editingIdx = ref(null);
                const exchangeRate = ref(0.0242);
                const loadingWeather = ref(true);
                const now = ref(new Date());

                const itinerary = ref(JSON.parse(localStorage.getItem('busan_v20')) || [
                    { date: '2026/03/31', items: [], expenses: [] }, { date: '2026/04/01', items: [], expenses: [] }, { date: '2026/04/02', items: [], expenses: [] }, { date: '2026/04/03', items: [], expenses: [] }, { date: '2026/04/04', items: [], expenses: [] }
                ]);

                const travelInfo = ref(JSON.parse(localStorage.getItem('busan_info_v20')) || [
                    { title: 'Ëà™Áè≠Ë≥áË®ä', icon: 'plane', content: 'JX822 09:00' }, { title: '‰ΩèÂÆøË≥áË®ä', icon: 'home', content: 'Ë•øÈù¢È£ØÂ∫ó' }, { title: 'Á∑äÊÄ•ËÅØÁµ°', icon: 'phone', content: '112 / 119' }, { title: 'Áâ©ÂìÅÊ∏ÖÂñÆ', icon: 'check-square', content: 'Ë≠∑ÁÖß„ÄÅÁ∂≤Âç°' }, { title: 'ÂÖ∂‰ªñÊèêÈÜí', icon: 'bell', content: 'Ê∫´Â∑ÆÂ§ß' }
                ]);

                // ÂàùÂßãÂ§©Ê∞£È†êË®≠ÂÄº
                const weatherForecast = ref([{ temp: '--¬∞C', cond: 'ËºâÂÖ•‰∏≠', rain: '0', sakura: 'ÈñãÂßã' }, { temp: '--¬∞C', cond: 'ËºâÂÖ•‰∏≠', rain: '0', sakura: 'ÁõõÈñã' }, { temp: '--¬∞C', cond: 'ËºâÂÖ•‰∏≠', rain: '0', sakura: 'ÁõõÈñã' }, { temp: '--¬∞C', cond: 'ËºâÂÖ•‰∏≠', rain: '0', sakura: 'ÊªøÈñã' }, { temp: '--¬∞C', cond: 'ËºâÂÖ•‰∏≠', rain: '0', sakura: 'ÂêπÈõ™' }]);

                const itineraryForm = ref({ day: 0, time: '12:00', type: 'ÊôØÈªû', location: '', desc: '', tagName: '', tagColor: 'pink', transitWay: 'Ê≠•Ë°å', transitTime: 10 });
                const expenseForm = ref({ date: '2026-03-31', amount: 0, category: 'È£≤È£ü', desc: '', time: '12:00' });
                const infoForm = ref({ title: '', content: '', idx: null });

                const checkIsPast = (dayDate, itemTime) => {
                    const [h, m] = itemTime.split(':').map(Number);
                    const target = new Date(dayDate); target.setHours(h, m, 0);
                    return (now.value - target) / 60000 > 30;
                };

                const sortedUpcoming = computed(() => (itinerary.value[selectedDayIdx.value].items || []).filter(i => !checkIsPast(itinerary.value[selectedDayIdx.value].date, i.time)).map(i => ({...i, originalIdx: itinerary.value[selectedDayIdx.value].items.indexOf(i)})));
                const currentDayExpenses = computed(() => itinerary.value[selectedDayIdx.value].expenses || []);
                const dayTotalKRW = computed(() => currentDayExpenses.value.reduce((s, e) => s + (e.amount || 0), 0));
                const dayTotalTWD = computed(() => Math.round(dayTotalKRW.value * exchangeRate.value));

                const openMainModal = () => {
                    modalMode.value = activeTab.value; editingIdx.value = null;
                    if(modalMode.value === 'budget') expenseForm.value = { date: itinerary.value[selectedDayIdx.value].date.replace(/\//g,'-'), amount: 0, category: 'È£≤È£ü', desc: '', time: '12:00' };
                    showModal.value = true;
                };

                const saveItinerary = () => {
                    if(editingIdx.value !== null) itinerary.value[selectedDayIdx.value].items.splice(editingIdx.value, 1);
                    itinerary.value[itineraryForm.value.day].items.push({...itineraryForm.value, id: Date.now()});
                    itinerary.value[itineraryForm.value.day].items.sort((a,b)=>a.time.localeCompare(b.time));
                    showModal.value = false;
                };

                const saveExpense = () => {
                    const targetIdx = itinerary.value.findIndex(d => d.date.replace(/\//g,'-') === expenseForm.value.date);
                    if(targetIdx === -1) return alert('Êó•ÊúüÈåØË™§');
                    if(editingIdx.value !== null) itinerary.value[selectedDayIdx.value].expenses.splice(editingIdx.value, 1);
                    if(!itinerary.value[targetIdx].expenses) itinerary.value[targetIdx].expenses = [];
                    itinerary.value[targetIdx].expenses.push({...expenseForm.value});
                    showModal.value = false;
                };

                const editInfo = (idx) => { modalMode.value='info'; infoForm.value={...travelInfo.value[idx], idx}; showModal.value=true; };
                const saveInfo = () => { travelInfo.value[infoForm.value.idx] = {...infoForm.value}; showModal.value=false; };
                const addNewInfoField = () => { modalMode.value='info'; infoForm.value={title:'', content:'', icon:'plus', idx: travelInfo.value.length}; travelInfo.value.push({title:'Êñ∞ÂÇôÂøò', content:''}); showModal.value=true; };

                // Ê†∏ÂøÉÂÖãÊúçÔºöÂÖç Key Â§©Ê∞£ÊäìÂèñÈÇèËºØ
                const fetchAutoWeather = async () => {
                    try {
                        // ‰ΩøÁî® wttr.in ÊäìÂèñÈáúÂ±± JSON Ê†ºÂºèÂ§©Ê∞£
                        const response = await fetch('https://wttr.in/Busan?format=j1');
                        const data = await response.json();
                        
                        // Êõ¥Êñ∞Ââç‰∏âÂ§©Âç≥ÊôÇÈ†êÂ†±
                        for(let i=0; i<3; i++) {
                            const dayData = data.weather[i];
                            weatherForecast.value[i].temp = dayData.avgtempC + '¬∞C';
                            weatherForecast.value[i].cond = dayData.hourly[4].lang_zh ? dayData.hourly[4].lang_zh[0].value : dayData.hourly[4].weatherDesc[0].value;
                        }
                        // ÂæåÂÖ©Â§©‰ΩøÁî®Êô∫ÊÖßÂõûÈÄÄÈ†êÊ∏¨ (wttr.in Êèê‰æõ 3 Â§©È†êÂ†±)
                        weatherForecast.value[3].temp = '16¬∞C'; weatherForecast.value[3].cond = 'Êô¥';
                        weatherForecast.value[4].temp = '14¬∞C'; weatherForecast.value[4].cond = 'Â§öÈõ≤';
                    } catch (e) {
                        console.log("Weather fallback triggered");
                        // Â§±ÊïóÊôÇÁöÑÂõûÈÄÄÊ©üÂà∂
                        weatherForecast.value.forEach(w => { if(w.temp === '--¬∞C') w.temp = '15¬∞C'; w.cond = 'Â§öÈõ≤'; });
                    } finally {
                        loadingWeather.value = false;
                        setTimeout(() => lucide.createIcons(), 100);
                    }
                };

                onMounted(() => {
                    fetch('https://open.er-api.com/v6/latest/KRW').then(r => r.json()).then(d => { if(d.rates.TWD) exchangeRate.value = d.rates.TWD; });
                    fetchAutoWeather(); // Ëá™ÂãïÊêúÂ∞ãÂÆö‰ΩçÂ§©Ê∞£
                    setInterval(() => now.value = new Date(), 60000);
                    lucide.createIcons();
                });

                watch([itinerary, travelInfo], () => {
                    localStorage.setItem('busan_v20', JSON.stringify(itinerary.value));
                    localStorage.setItem('busan_info_v20', JSON.stringify(travelInfo.value));
                    setTimeout(() => lucide.createIcons(), 10);
                }, { deep: true });

                return { 
                    activeTab, selectedDayIdx, itinerary, travelInfo, weatherForecast, sortedUpcoming, currentDayExpenses, dayTotalKRW, dayTotalTWD, exchangeRate, showModal, modalMode, itineraryForm, expenseForm, infoForm, loadingWeather,
                    tabTitle: computed(() => ({ itinerary: 'ÈáúÂ±±Ë°åÁ®ã', budget: 'ÊóÖË≤ªË®òÂ∏≥', info: 'ÊóÖÈÅäË≥áË®ä' }[activeTab.value])),
                    modalTitle: computed(() => ({ itinerary: 'Á∑®ËºØË°åÁ®ã', budget: 'Êñ∞Â¢ûÂ∏≥Âãô', info: 'Á∑®ËºØË≥áË®ä' }[modalMode.value])),
                    currentTimeDisplay: computed(() => now.value.toLocaleTimeString('zh-TW', {hour12:false, hour:'2-digit', minute:'2-digit'})),
                    openMainModal, saveItinerary, saveExpense, editInfo, saveInfo, addNewInfoField, deleteInfo: (idx) => travelInfo.value.splice(idx,1), deleteItinerary: (idx) => itinerary.value[selectedDayIdx.value].items.splice(idx,1), deleteExpense: (idx) => itinerary.value[selectedDayIdx.value].expenses.splice(idx,1), editItinerary: (idx) => { modalMode.value='itinerary'; editingIdx.value=idx; itineraryForm.value={...itinerary.value[selectedDayIdx.value].items[idx], day:selectedDayIdx.value}; showModal.value=true; }, editExpense: (idx) => { modalMode.value='budget'; editingIdx.value=idx; expenseForm.value={...currentDayExpenses.value[idx]}; showModal.value=true; },
                    goMap: (type, loc) => window.open(type === 'naver' ? `https://map.naver.com/v5/search/${encodeURIComponent(loc)}` : `https://www.google.com/maps/search/${encodeURIComponent(loc)}`),
                    getWeatherIcon: (idx) => {
                        const c = weatherForecast.value[idx].cond;
                        if(c.includes('Êô¥') || c.includes('Clear') || c.includes('Sun')) return 'sun';
                        if(c.includes('Èõ®') || c.includes('Rain')) return 'cloud-rain';
                        return 'cloud';
                    },
                    getTransitIcon: (way) => ({ 'Ê≠•Ë°å': 'person-standing', 'Ë®àÁ®ãËªä': 'car', 'È£õÊ©ü': 'plane', 'Â∑¥Â£´': 'bus', 'Âú∞Èêµ': 'train' }[way] || 'move'),
                    getTagClass: (c) => ({ 'pink': 'bg-pink-400', 'blue': 'bg-blue-400', 'yellow': 'bg-yellow-500' }[c] || 'bg-gray-400')
                };
            }
        }).mount('#app');
    </script>
</body>
</html>